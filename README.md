This is an annotaed implementation of `selective_scan_cuda` from Mamba. This is not runnable code, but a reference for what is happening in the CUDA kernel. I wrote this in Python for people who don't know C++. There are 
some slight differences between the Python and C++ code, but the general idea is the same.

Additionally, I write comments in the code to explain what is going on and why they choose to do some things. A basic understanding of what a CUDA kernel is would be helpful, though you can still get a general idea of what is going on without it.
